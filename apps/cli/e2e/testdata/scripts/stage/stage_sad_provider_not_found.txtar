# Test stage shows error when provider is not found
# Uses the valid.blueprint.yaml fixture that requires "example" provider

wait_engine

! exec bluelink stage --blueprint-file=s3://test-blueprints/valid.blueprint.yaml --connect-protocol=tcp --engine-endpoint=$BLUELINK_ENGINE_ENDPOINT --engine-auth-config-file=engine.auth.json
stdout 'Error during change staging'
stdout 'provider "example" not found'

-- bluelink.config.toml --
# Empty config file

-- engine.auth.json --
{
  "method": "apiKey",
  "apiKey": "test-api-key"
}
