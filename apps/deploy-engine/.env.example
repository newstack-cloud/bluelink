# =============================================================================
# Bluelink Deploy Engine Configuration
# =============================================================================
# This file can be used as a configuration file or as a reference for
# environment variables. See README.md for details on configuration priority
# and file-based configuration using config.json/yaml/toml files.

# =============================================================================
# Server Configuration
# =============================================================================

# API version to use (default: v1)
# BLUELINK_DEPLOY_ENGINE_API_VERSION=v1

# Port for HTTP server (default: 8325)
# BLUELINK_DEPLOY_ENGINE_PORT=8325

# Use Unix socket instead of TCP (default: false)
# BLUELINK_DEPLOY_ENGINE_USE_UNIX_SOCKET=false

# Unix socket path (default: /tmp/bluelink.sock)
# BLUELINK_DEPLOY_ENGINE_UNIX_SOCKET_PATH=/tmp/bluelink.sock

# Only allow loopback connections (default: true)
BLUELINK_DEPLOY_ENGINE_LOOPBACK_ONLY=false

# Environment mode: development or production (default: production)
BLUELINK_DEPLOY_ENGINE_ENVIRONMENT=development

# Log level: debug, info, warn, error, dpanic, panic, fatal (default: info)
BLUELINK_DEPLOY_ENGINE_LOG_LEVEL=debug

# =============================================================================
# Authentication Configuration
# =============================================================================

# OAuth2/OIDC JWT issuer URL (required if using JWT auth)
BLUELINK_DEPLOY_ENGINE_AUTH_OAUTH2_OIDC_JWT_ISSUER=oidc-local-server

# Use HTTPS for issuer metadata requests (default: true)
BLUELINK_DEPLOY_ENGINE_AUTH_OAUTH2_OIDC_JWT_ISSUER_SECURE=false

# OAuth2/OIDC JWT audience (required if using JWT auth)
BLUELINK_DEPLOY_ENGINE_AUTH_OAUTH2_OIDC_JWT_AUDIENCE=oidc-local-client

# JWT signature algorithm (default: HS256)
BLUELINK_DEPLOY_ENGINE_AUTH_OAUTH2_OIDC_JWT_SIGNATURE_ALGORITHM=RS256

# Bluelink Signature v1 key pairs (comma-separated keyId:secretKey pairs)
BLUELINK_DEPLOY_ENGINE_AUTH_BLUELINK_SIGNATURE_V1_KEY_PAIRS=test-key-id:test-secret

# Bluelink API keys (comma-separated list)
BLUELINK_DEPLOY_ENGINE_AUTH_BLUELINK_API_KEYS=test-api-key

# =============================================================================
# Plugins Configuration
# =============================================================================

# Plugin directories (colon-separated paths)
# Default (Linux/macOS): $HOME/.bluelink/engine/plugins/bin
# Default (Windows): %LOCALAPPDATA%\NewStack\Bluelink\engine\plugins
# BLUELINK_DEPLOY_ENGINE_PLUGIN_PATH=$HOME/.bluelink/engine/plugins/bin

# Plugin log file directory
# Default (Linux/macOS): $HOME/.bluelink/engine/plugins/logs
# Default (Windows): %LOCALAPPDATA%\NewStack\Bluelink\engine\plugins\logs
# BLUELINK_DEPLOY_ENGINE_PLUGIN_LOG_FILE_ROOT_DIR=$HOME/.bluelink/engine/plugins/logs

# Plugin launch timeout in milliseconds (default: 15000)
# BLUELINK_DEPLOY_ENGINE_PLUGINS_V1_LAUNCH_WAIT_TIMEOUT_MS=15000

# Total plugin launch timeout in milliseconds (default: 60000)
# BLUELINK_DEPLOY_ENGINE_PLUGINS_V1_TOTAL_LAUNCH_WAIT_TIMEOUT_MS=60000

# Resource stabilisation polling timeout in milliseconds (default: 3600000)
# BLUELINK_DEPLOY_ENGINE_PLUGINS_V1_RESOURCE_STABILISATION_POLLING_TIMEOUT_MS=3600000

# Plugin to plugin call timeout in milliseconds (default: 120000)
# BLUELINK_DEPLOY_ENGINE_PLUGINS_V1_PLUGIN_TO_PLUGIN_CALL_TIMEOUT_MS=120000

# =============================================================================
# Blueprints Configuration
# =============================================================================

# Validate blueprints after applying transformations (default: false)
# BLUELINK_DEPLOY_ENGINE_BLUEPRINTS_VALIDATE_AFTER_TRANSFORM=false

# Enable drift detection (default: true)
# BLUELINK_DEPLOY_ENGINE_BLUEPRINTS_ENABLE_DRIFT_CHECK=true

# Resource stabilisation polling interval in milliseconds (default: 5000)
# BLUELINK_DEPLOY_ENGINE_BLUEPRINTS_RESOURCE_STABILISATION_POLLING_INTERVAL_MS=5000

# Default retry policy (JSON string)
# BLUELINK_DEPLOY_ENGINE_BLUEPRINTS_DEFAULT_RETRY_POLICY=

# Deployment timeout in seconds (default: 10800)
# BLUELINK_DEPLOY_ENGINE_BLUEPRINTS_DEPLOYMENT_TIMEOUT=10800

# =============================================================================
# State Configuration
# =============================================================================

# Storage engine: memfile or postgres (default: memfile)
BLUELINK_DEPLOY_ENGINE_STATE_STORAGE_ENGINE=memfile

# Recently queued events threshold in seconds (default: 300)
# BLUELINK_DEPLOY_ENGINE_STATE_RECENTLY_QUEUED_EVENTS_THRESHOLD=300

# --- Memfile Storage Engine Configuration ---

# State directory for memfile storage
# Default (Linux/macOS): $HOME/.bluelink/engine/state
# Default (Windows): %LOCALAPPDATA%\NewStack\Bluelink\engine\state
# BLUELINK_DEPLOY_ENGINE_STATE_MEMFILE_STATE_DIR=$HOME/.bluelink/engine/state

# Max guide file size in bytes (default: 1048576)
# BLUELINK_DEPLOY_ENGINE_STATE_MEMFILE_MAX_GUIDE_FILE_SIZE=1048576

# Max event partition size in bytes (default: 10485760)
# BLUELINK_DEPLOY_ENGINE_STATE_MEMFILE_MAX_EVENT_PARTITION_SIZE=10485760

# --- Postgres Storage Engine Configuration ---

# PostgreSQL user (required if using postgres storage)
BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_USER=postgres

# PostgreSQL password (required if using postgres storage)
BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_PASSWORD=postgres

# PostgreSQL host (default: localhost)
BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_HOST=deploy_engine_local_postgres

# PostgreSQL port (default: 5432)
BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_PORT=5432

# PostgreSQL database name (required if using postgres storage)
BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_DATABASE=postgres

# PostgreSQL SSL mode: disable, require, verify-ca, verify-full (default: disable)
# BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_SSL_MODE=disable

# PostgreSQL pool max connections (default: 100)
# BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_POOL_MAX_CONNS=100

# PostgreSQL pool max connection lifetime (default: 1h30m)
# BLUELINK_DEPLOY_ENGINE_STATE_POSTGRES_POOL_MAX_CONN_LIFETIME=1h30m

# =============================================================================
# Resolvers Configuration
# =============================================================================

# Custom S3 endpoint (optional)
# BLUELINK_DEPLOY_ENGINE_RESOLVERS_S3_ENDPOINT=

# Custom GCS endpoint (optional)
# BLUELINK_DEPLOY_ENGINE_RESOLVERS_GCS_ENDPOINT=

# HTTPS client timeout in seconds (default: 30)
# BLUELINK_DEPLOY_ENGINE_RESOLVERS_HTTPS_CLIENT_TIMEOUT=30

# =============================================================================
# Maintenance Configuration
# =============================================================================

# Blueprint validation retention period in seconds (default: 604800)
# BLUELINK_DEPLOY_ENGINE_MAINTENANCE_BLUEPRINT_VALIDATION_RETENTION_PERIOD=604800

# Changeset retention period in seconds (default: 604800)
# BLUELINK_DEPLOY_ENGINE_MAINTENANCE_CHANGESET_RETENTION_PERIOD=604800

# Events retention period in seconds (default: 604800)
# BLUELINK_DEPLOY_ENGINE_MAINTENANCE_EVENTS_RETENTION_PERIOD=604800

# Reconciliation results retention period in seconds (default: 604800)
# BLUELINK_DEPLOY_ENGINE_MAINTENANCE_RECONCILIATION_RESULTS_RETENTION_PERIOD=604800
